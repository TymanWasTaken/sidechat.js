function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},e.apply(this,arguments)}class t extends Error{constructor(e){super(e),this.name="SidechatAPIError"}}const r={Accept:"application/json","Content-Type":"application/json"},o=async e=>{try{const t=await fetch("https://api.sidechat.lol/v1/login_register",{method:"POST",headers:r,body:JSON.stringify({phone_number:`+1${e}`,version:3})});return await t.json()}catch(e){throw console.error(error),new t("Failed to request SMS verification.")}},s=async(e,o)=>{try{const t=await fetch("https://api.sidechat.lol/v1/verify_phone_number",{method:"POST",headers:r,body:JSON.stringify({phone_number:`+1${e}`,code:o.toUpperCase()})});return await t.json()}catch(e){throw console.error(e),new t("Failed verify this code.")}},a=async(e,o)=>{if(e<13)throw new t("You're too young to use Offsides.");try{const t=await fetch("https://api.sidechat.lol/v1/complete_registration",{method:"POST",headers:r,body:JSON.stringify({age:Number(e),registration_id:o})});return await t.json()}catch(e){throw console.error(e),new t("Failed verify this code.")}},i=async(o,s)=>{try{const a=await fetch("https://api.sidechat.lol/v2/users/register_email",{method:"POST",headers:e({},r,{Authorization:`Bearer ${s}`}),body:JSON.stringify({email:o})}),i=await a.json();if(i.message)throw new t(i.message);return i}catch(e){throw console.error(error),new t("Failed to request email verification.")}},n=async o=>{try{const s=await fetch("https://api.sidechat.lol/v1/users/check_email_verified",{method:"GET",headers:e({},r,{Authorization:`Bearer ${o}`})}),a=await s.json();if(a.verified_email_updates_response)return a.verified_email_updates_response;throw new t((null==a?void 0:a.message)||"Email is not verified.")}catch(e){throw console.error(error),new t("Email is not verified.")}},c=async(o,s)=>{try{const t=await fetch("https://api.sidechat.lol/v1/register_device_token",{method:"POST",headers:e({},r,{Authorization:`Bearer ${s}`}),body:JSON.stringify({build_type:"release",bundle_id:"com.flowerave.sidechat",device_token:o})}),a=await t.json();return await AsyncStorage.setItem("deviceID",o),a}catch(e){throw console.error(e),new t("Failed verify this code.")}},h=async(o,s="")=>{try{const t=await fetch(`https://api.sidechat.lol/v1/updates?group_id=${s}`,{method:"GET",headers:e({},r,{Authorization:`Bearer ${o}`})});return await t.json()}catch(e){throw console.error(e),new t("Failed to get posts from group.")}},d=async(o,s,a="hot",i)=>{try{const t=await fetch(`https://api.sidechat.lol/v1/posts?group_id=${o}&type=${a}${i?"&cursor="+i:""}`,{method:"GET",headers:e({},r,{Authorization:`Bearer ${s}`})});return await t.json()}catch(e){throw console.error(e),new t("Failed to get posts from group.")}},p=async(o,s,a)=>{try{const t=await fetch("https://api.sidechat.lol/v1/posts/set_vote",{method:"POST",headers:e({},r,{Authorization:`Bearer ${s}`}),body:JSON.stringify({post_id:o,vote_status:a})});return await t.json()}catch(e){throw console.error(e),new t("Failed to change the vote on post.")}},l=async(o,s)=>{try{const a=await fetch(`https://api.sidechat.lol/v1/posts/comments/?post_id=${o}`,{method:"GET",headers:e({},r,{Authorization:`Bearer ${s}`})});function i(e){const t=new Map,r=[];return e.forEach(e=>{t.set(e.id,e);const o=t.get(e.reply_post_id);o&&e.reply_post_id!==e.parent_post_id?(o.replies||(o.replies=[]),o.replies.push(e)):r.push(e)}),n(r)}function n(e){return e.reduce((e,t)=>(e.push(t),t.replies&&e.push(...n(t.replies)),e),[])}return i((await a.json()).posts)}catch(c){throw console.error(c),new t("Failed to get comments on post.")}},u=async o=>{try{const t=await fetch("https://api.sidechat.lol/v1/groups/explore",{method:"GET",headers:e({},r,{Authorization:`Bearer ${o}`})});return(await t.json()).groups}catch(e){throw console.error(e),new t("Failed to get groups from explore.")}};export{n as checkEmailVerification,u as getAvailableGroups,d as getGroupPosts,l as getPostComments,h as getUserAndGroup,o as loginViaSMS,i as registerEmail,a as setAge,c as setDeviceID,p as setVote,s as verifySMSCode};
//# sourceMappingURL=sidechat.modern.js.map
