function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(e=function(){return!!t})()}function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},t.apply(this,arguments)}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function n(t){var i="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,n)}function n(){return function(t,r,n){if(e())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,r);var s=new(t.bind.apply(t,i));return n&&o(s,n.prototype),s}(t,arguments,r(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,t)},n(t)}var i=/*#__PURE__*/function(e){var t,r;function n(t){var r;return(r=e.call(this,t)||this).name="SidechatAPIError",r}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,o(t,r),n}(/*#__PURE__*/n(Error));function s(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}exports.SidechatAPIClient=function(e){var r=this,o=this,n=this,u=this,c=this,a=this,h=this,l=this,f=this,d=this,p=this,v=this;void 0===e&&(e=""),this.defaultHeaders={Accept:"application/json","Content-Type":"application/json"},this.setToken=function(e){v.userToken=e},this.loginViaSMS=function(e){try{return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/login_register",{method:"POST",headers:r.defaultHeaders,body:JSON.stringify({phone_number:"+1"+e,version:3})})).then(function(e){return Promise.resolve(e.json())})},function(e){throw console.error(e),new i("Failed to request SMS verification.")}))}catch(e){return Promise.reject(e)}},this.verifySMSCode=function(e,t){try{return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/verify_phone_number",{method:"POST",headers:o.defaultHeaders,body:JSON.stringify({phone_number:"+1"+e,code:t.toUpperCase()})})).then(function(e){return Promise.resolve(e.json()).then(function(e){var t;return null!=e&&null!=(t=e.logged_in_user)&&t.token&&(o.userToken=e.logged_in_user.token),e})})},function(e){throw console.error(e),new i("Failed verify this code.")}))}catch(e){return Promise.reject(e)}},this.setAge=function(e,t){try{if(e<13)throw new i("You're too young to use Offsides.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/complete_registration",{method:"POST",headers:n.defaultHeaders,body:JSON.stringify({age:Number(e),registration_id:t})})).then(function(e){return Promise.resolve(e.json()).then(function(e){return e.token&&(n.userToken=e.token),e})})},function(e){throw console.error(e),new i("Failed verify this code.")}))}catch(e){return Promise.reject(e)}},this.registerEmail=function(e){try{if(!u.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v2/users/register_email",{method:"POST",headers:t({},u.defaultHeaders,{Authorization:"Bearer "+u.userToken}),body:JSON.stringify({email:e})})).then(function(e){return Promise.resolve(e.json()).then(function(e){if(e.message)throw new i(e.message);return e})})},function(){throw console.error(error),new i("Failed to request email verification.")}))}catch(e){return Promise.reject(e)}},this.checkEmailVerification=function(){try{if(!c.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/users/check_email_verified",{method:"GET",headers:t({},c.defaultHeaders,{Authorization:"Bearer "+c.userToken})})).then(function(e){return Promise.resolve(e.json()).then(function(e){if(e.verified_email_updates_response)return e.verified_email_updates_response;throw new i((null==e?void 0:e.message)||"Email is not verified.")})})},function(){throw console.error(error),new i("Email is not verified.")}))}catch(e){return Promise.reject(e)}},this.setDeviceID=function(e){try{if(!a.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/register_device_token",{method:"POST",headers:t({},a.defaultHeaders,{Authorization:"Bearer "+a.userToken}),body:JSON.stringify({build_type:"release",bundle_id:"com.flowerave.sidechat",device_token:e})})).then(function(t){return Promise.resolve(t.json()).then(function(t){return Promise.resolve(AsyncStorage.setItem("deviceID",e)).then(function(){return t})})})},function(e){throw console.error(e),new i("Failed verify this code.")}))}catch(e){return Promise.reject(e)}},this.getUserAndGroup=function(e){void 0===e&&(e="");try{if(!h.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/updates?group_id="+e,{method:"GET",headers:t({},h.defaultHeaders,{Authorization:"Bearer "+h.userToken})})).then(function(e){return Promise.resolve(e.json())})},function(e){throw console.error(e),new i("Failed to get posts from group.")}))}catch(e){return Promise.reject(e)}},this.getGroupPosts=function(e,r,o){void 0===r&&(r="hot");try{if(!l.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/posts?group_id="+e+"&type="+r+(o?"&cursor="+o:""),{method:"GET",headers:t({},l.defaultHeaders,{Authorization:"Bearer "+l.userToken})})).then(function(e){return Promise.resolve(e.json())})},function(e){throw console.error(e),new i("Failed to get posts from group.")}))}catch(e){return Promise.reject(e)}},this.setVote=function(e,r){try{if(!f.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/posts/set_vote",{method:"POST",headers:t({},f.defaultHeaders,{Authorization:"Bearer "+f.userToken}),body:JSON.stringify({post_id:e,vote_status:r})})).then(function(e){return Promise.resolve(e.json())})},function(e){throw console.error(e),new i("Failed to change the vote on post.")}))}catch(e){return Promise.reject(e)}},this.getPostComments=function(e){try{if(!d.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/posts/comments/?post_id="+e,{method:"GET",headers:t({},d.defaultHeaders,{Authorization:"Bearer "+d.userToken})})).then(function(e){function t(e){var t=new Map,o=[];return e.forEach(function(e){t.set(e.id,e);var r=t.get(e.reply_post_id);r&&e.reply_post_id!==e.parent_post_id?(r.replies||(r.replies=[]),r.replies.push(e)):o.push(e)}),r(o)}function r(e){return e.reduce(function(e,t){return e.push(t),t.replies&&e.push.apply(e,r(t.replies)),e},[])}return Promise.resolve(e.json()).then(function(e){return t(e.posts)})})},function(e){throw console.error(e),new i("Failed to get comments on post.")}))}catch(e){return Promise.reject(e)}},this.getAvailableGroups=function(){try{if(!p.userToken)throw new i("User is not authenticated.");return Promise.resolve(s(function(){return Promise.resolve(fetch("https://api.sidechat.lol/v1/groups/explore",{method:"GET",headers:t({},p.defaultHeaders,{Authorization:"Bearer "+p.userToken})})).then(function(e){return Promise.resolve(e.json()).then(function(e){return Promise.resolve(e.groups)})})},function(e){throw console.error(e),new i("Failed to get groups from explore.")}))}catch(e){return Promise.reject(e)}},e&&(this.userToken=e)},exports.SidechatAPIError=i;
//# sourceMappingURL=sidechat.cjs.map
